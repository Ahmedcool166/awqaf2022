<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initialscale=
1.0">
<title>Document</title>
<link rel="stylesheet" href="stylesheet.css" type="text/css" charset="utf-8" />
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="./html2canvas.js"></script>
<script src="./html2canvas.min.js"></script>
</head>
<body>

<center style="
    width: min-width: fit-content;
">
<br>
<h1> خدمة اصدار التهنئة من إدارة أوقاف صالح الراجحي </h1>
<br>
<div id="imghtml" class="surface" style="
    width: fit-content;
    HEIGHT: fit-content;
	 display: none;
">



<svg id="imgsvg" xmlns="http://www.w3.org/2000/svg" width="1000" height="1000"><image id="imageINSVG" x="0" y="0" width="1000px" height="1000px" class="image-preview visible" href="./Ramdan2022_New.jpg"></image><defs><filter id="item-filter-1-shadow-2" width="323.46443174988883" height="61.00652967982502" filterUnits="objectBoundingBox" primitiveUnits="userSpaceOnUse"><feGaussianBlur in="SourceAlpha" stdDeviation="2.893471676714504"></feGaussianBlur><feOffset dx="2.893471676714504" dy="2.893471676714504" result="OFFSETBLUR"></feOffset><feComponentTransfer in="OFFSETBLUR" result="SHADOW"><feFuncA type="linear" slope="0.5"></feFuncA></feComponentTransfer><feMerge><feMergeNode in="SHADOW"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs>    <text class="textGE"  style="direction: rtl; font-family:GE SS TWO BOLD;" data-proxy-id="21" fill="#006734" cursor="default"  filter="url(#item-filter-1-shadow-2)"  font-size="35" dominant-baseline="text-before-edge"  x="700" y="800" id="txtName"></text>
<rect class="selection" transform="" x="0" y="0" width="0" height="0"></rect></svg>




</div>
<br>
<br>

<button id="clickButton">اضغط هنا بعد كتابة الأسم</button>

<input id="readTheInput" dir="rtl" placeholder="قم بكتابة اسمك هنا">

<br>
<br>

 <input id="btn_convert" type="button" value="تحميل الصورة" />
<br>
<br>
<canvas class="textGE"  style="direction: rtl; font-family:GE SS TWO BOLD;" id="canvas1" width="1000" height="1000"  ></canvas>


</center>


<script>
    document.getElementById("clickButton").addEventListener("click", () =>{
	
	$("#txtName").text(document.getElementById("readTheInput").value);
		
		var can = document.getElementById('canvas1');
var ctx = can.getContext('2d');

var rect = document.getElementById("txtName").getBoundingClientRect();
console.log(rect.top, rect.right, rect.bottom, rect.left);


//var svg = document.getElementById('mySVG');

ctx.imageSmoothingEnabled = false;
var svgElement = document.getElementById('imgsvg');
let {width, height} = svgElement.getBBox(); 
let clonedSvgElement = svgElement.cloneNode(true);
// true for deep clone
let outerHTML = clonedSvgElement.outerHTML,
  blob = new Blob([outerHTML],{type:'image/svg+xml;charset=utf-8'});
  let URL = window.URL || window.webkitURL || window;
let blobURL = URL.createObjectURL(blob);

var background = new Image();
background.src = "./Ramdan2022_New.jpg";





var img = new Image();
img.onload = function() {
  can.width = this.naturalWidth;
  can.height = this.naturalHeight;
ctx.imageSmoothingEnabled = false;
ctx.drawImage(background, 0, 0);

const x = (can.width / 2)-15;

ctx.beginPath();
ctx.moveTo(x, 0);
ctx.stroke();

<!-- ctx.drawImage(img, 0, 0); -->
ctx.font = 'bold 35px GE SS TWO BOLD';
ctx.fillStyle = '#006734';
ctx.textAlign = 'center';
ctx.fillText(document.getElementById("readTheInput").value,x , 850);
ctx.filter = "none";
}

img.src = blobURL;
		
    });
	

</script>

 <script>
       document.getElementById("btn_convert").addEventListener("click", function() {
		html2canvas(document.getElementById("canvas1",{ useCORS:true}),
			{
				allowTaint: true,
				useCORS: true
			}).then(function (canvas) {
				var anchorTag = document.createElement("a");
				document.body.appendChild(anchorTag);
				<!-- document.getElementById("previewImg").appendChild(canvas); -->
				anchorTag.setAttribute('crossorigin', 'anonymous'); // works for me
				anchorTag.download = "Rajhi_Ramdan2022.jpg";
				anchorTag.href = canvas.toDataURL();
				anchorTag.target = '_blank';
				anchorTag.click();
			});
			
  });


	
    </script>




</body></html>
